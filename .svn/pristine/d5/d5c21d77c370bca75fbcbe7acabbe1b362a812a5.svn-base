//
//  DWReasionViewController.m
//  zhaiyi
//
//  Created by Apple on 15/12/5.
//  Copyright © 2015年 apple. All rights reserved.
//

#import "DWReasionViewController.h"
#import "DWQuitReasionCell.h"

@interface DWReasionViewController ()
{
    
    DWQuitReasionCell *cell;
    NSInteger SelectIndex;
    UITextView *textV;
    
}
@end

@implementation DWReasionViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    [self.navigationItem setTitle:@"辞退原因"];
    [self configueHeaderView];
    //[self configueFooterView];
    [self.tableView registerNib:[UINib nibWithNibName:@"DWQuitReasionCell" bundle:nil] forCellReuseIdentifier:@"DWQuitReasionCell"];
    
    [self addTap];
    
    
}
-(void)addTap
{
    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(TableviewClicked:)];
    [self.tableView addGestureRecognizer:tap];
}

- (void)configueHeaderView{
    
    UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 40)];
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(8, 8, [UIScreen mainScreen].bounds.size.width, 26)];
    label.text = @"请选择辞退的原因";
    label.textColor = [UIColor colorWithWhite:0.6 alpha:1];
    [headerView addSubview:label];
    headerView.backgroundColor = [UIColor colorWithWhite:0.95 alpha:1];
    self.tableView.tableHeaderView = headerView;
}

- (void)configueFooterView{
    
    UIView *footerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 100)];
    footerView.userInteractionEnabled = YES;
    textV = [[UITextView alloc] initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 20)];
    
   // textView.backgroundColor = [UIColor redColor];
    
    [footerView addSubview:textV];
    textV.backgroundColor = [UIColor colorWithWhite:0.95 alpha:1];
    
    // 辞退按钮
    UIButton *quitButton = [[UIButton alloc] initWithFrame:CGRectMake(8, 108, [UIScreen mainScreen].bounds.size.width - 16, 44)];
    
    quitButton.backgroundColor = [UIColor colorWithRed:0.145 green:0.831 blue:0.765 alpha:1.000];
    
    [quitButton setTitle:@"提交" forState:UIControlStateNormal];
    
    [quitButton addTarget:self action:@selector(tijiao) forControlEvents:UIControlEventTouchUpInside];

    [footerView addSubview:quitButton];
    
    self.tableView.tableFooterView = footerView;
    self.tableView.tableFooterView.userInteractionEnabled = YES;
   
}

#pragma mark - Table view data source
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 4;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    
        cell = [tableView dequeueReusableCellWithIdentifier:@"DWQuitReasionCell" forIndexPath:indexPath];

    if (indexPath.row == 0) {
        cell.leftLabel.text = @"工作态度差";
        [cell.rightBtn setImage:[UIImage imageNamed:@"找工人4"] forState:UIControlStateNormal];
    }else if(indexPath.row == 1){
        cell.leftLabel.text = @"技术不达标";
        [cell.rightBtn setImage:[UIImage imageNamed:@"找工人4"] forState:UIControlStateNormal];
    }else if(indexPath.row == 2){
        cell.leftLabel.text = @"消极怠工";
        [cell.rightBtn setImage:[UIImage imageNamed:@"找工人4"] forState:UIControlStateNormal];
    }else if(indexPath.row == 3){
        cell.leftLabel.text = @"其他";
        [cell.rightBtn setImage:[UIImage imageNamed:@"找工人4"] forState:UIControlStateNormal];
    }
    
    if (indexPath.row == SelectIndex) {
        
        [cell.rightBtn setImage:[UIImage imageNamed:@"找工人5"] forState:UIControlStateNormal];
    }
    
    return cell;
}


-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    SelectIndex  =indexPath.row;
    
    cell = [tableView cellForRowAtIndexPath:indexPath];
    [self.tableView reloadData];
}

//提交－－辞退
-(void)tijiao
{
    NSLog(@"123");
    NSMutableDictionary *parm = [NSMutableDictionary dictionary];
    
    NSLog(@"%@",self.UserAcount.username);
    NSLog(@"%@",_OrderModel.ID );
    NSLog(@"%@",cell.leftLabel.text);
    
    [parm setObject:self.UserAcount.ID forKey:@"user_id"];
    [parm setObject:_OrderModel.ID forKey:@"order_id"];
    
    [parm setObject:cell.leftLabel.text forKey:@"content"];
    
    //辞退工人
    [NetWork postNoParm:ciTuiGongRen params:parm success:^(id responseObj) {

        NSLog(@"%@",responseObj);
        
        if ([[responseObj objectForKey:@"code"]isEqualToString:@"1000"]) {
            [ITTPromptView showMessage:@"辞退成功"];
            NSArray *arrControl = self.navigationController.viewControllers;
            [self.navigationController popToViewController:arrControl[2] animated:YES];
        }
        
    } failure:^(NSError *error) {
        NSLog(@"%@",error);
    }];
    
}

-(UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section
{
    
    UIView *footerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 100)];
    footerView.userInteractionEnabled = YES;
    UITextView *textView = [[UITextView alloc] initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 100)];
    
    // textView.backgroundColor = [UIColor redColor];
    
    [footerView addSubview:textView];
    textView.backgroundColor = [UIColor colorWithWhite:0.95 alpha:1];
    
    // 辞退按钮
    UIButton *quitButton = [[UIButton alloc] initWithFrame:CGRectMake(8, 108, [UIScreen mainScreen].bounds.size.width - 16, 44)];
    
    quitButton.backgroundColor = [UIColor colorWithRed:0.145 green:0.831 blue:0.765 alpha:1.000];
    
    [quitButton setTitle:@"提交" forState:UIControlStateNormal];
    
    [quitButton addTarget:self action:@selector(tijiao) forControlEvents:UIControlEventTouchUpInside];
    
    [footerView addSubview:quitButton];
    
    return footerView;
    //self.tableView.tableFooterView = footerView;
    //self.tableView.tableFooterView.userInteractionEnabled = YES;
}

-(CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
{
    return 200;
}

-(void)TableviewClicked:(UITapGestureRecognizer*)tap
{
    NSLog(@"123");
    [textV resignFirstResponder];
    
}



@end
