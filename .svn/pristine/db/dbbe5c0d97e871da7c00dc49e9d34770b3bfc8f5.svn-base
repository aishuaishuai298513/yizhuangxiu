//
//  MyResignViewController.m
//  zhaiyi
//
//  Created by ass on 16/1/13.
//  Copyright © 2016年 apple. All rights reserved.
//

#import "MyResignViewController.h"

@interface MyResignViewController ()

@property (weak, nonatomic) IBOutlet UITextField *telPhone;
@property (weak, nonatomic) IBOutlet UITextField *yzmNum;
@property (weak, nonatomic) IBOutlet UITextField *passWord;

@property (nonatomic,assign) BOOL isGhuZhu;

//线
@property (weak, nonatomic) IBOutlet UIView *guZhuLine;

@property (weak, nonatomic) IBOutlet UIView *gongRenLine;

- (IBAction)guZhuBtn:(id)sender;

- (IBAction)gongRenBtn:(id)sender;


- (IBAction)getYzmbtn:(id)sender;


- (IBAction)ReginBtn:(id)sender;


@end

@implementation MyResignViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    
    self.title = @"注册";
    self.isGhuZhu = YES;
    
  self.navigationItem.leftBarButtonItem = [UIBarButtonItem itemWithImage:@"left" selectedImage:@"left" target:self action:@selector(back)];
    
}

-(void)back
{
    [self.navigationController popViewControllerAnimated:YES];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

/*
#pragma mark - Navigation

// In a storyboard-based application, you will often want to do a little preparation before navigation
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    // Get the new view controller using [segue destinationViewController].
    // Pass the selected object to the new view controller.
}
*/

- (IBAction)guZhuBtn:(id)sender {
    
    self.isGhuZhu = YES;
    self.guZhuLine.alpha = 1;
    self.gongRenLine.alpha = 0.1;
}

- (IBAction)gongRenBtn:(id)sender {
    
    self.isGhuZhu = NO;
    self.guZhuLine.alpha = 0.1;
    self.gongRenLine.alpha = 1;
}

- (IBAction)getYzmbtn:(id)sender {
    
    NSString *mobil = self.telPhone.text;
    NSLog(@"%@",mobil);
    NSMutableDictionary *parm = [NSMutableDictionary dictionary];
    
    [parm setObject:mobil forKey:@"mobile"];
    [NetWork postNoParm:getYanZhengMa params:parm success:^(id responseObj) {
        
        NSLog(@"%@",responseObj);
        if ([[responseObj objectForKey:@"status"]isEqualToString:@"1000"]) {
            
            [ITTPromptView showMessage:@"验证码已发送，请注意查收"];
        }else
        {
            [ITTPromptView showMessage:[responseObj objectForKey:@"message"]];
        }
        
    } failure:^(NSError *error) {
        
    }];
    
}

- (IBAction)ReginBtn:(id)sender {
    
        NSString *userName = self.telPhone.text;
        NSString *PassWord = self.passWord.text;
        NSString *yzmtext = self.yzmNum.text;
        NSString *type;
        NSMutableDictionary *parms = [NSMutableDictionary dictionary];
        [parms setObject:userName forKey:@"moblie"];
        [parms setObject:PassWord forKey:@"password"];
        [parms setObject:yzmtext forKey:@"code"];
        //yes为雇主
        if (_isGhuZhu) {
            [parms setObject:@"79" forKey:@"type"];
            type = @"79";
         }
        //工人
          else
         {
            [parms setObject:@"78" forKey:@"type"];
             type = @"78";
         }
    
         NSLog(@"%@",parms);
    
    
        NSString *url = [NSString stringWithFormat:@"http://zhaiyi.bjqttd.com/api/user/register?mobile=%@&password=%@&type=%@&code=%@",userName,PassWord,type,yzmtext];
        NSLog(@"%@",url);
        [NetWork get:url params:nil success:^(id responseObj) {
            NSLog(@"%@",responseObj);
            if ([[responseObj objectForKey:@"code"]isEqualToString:@"1000"]) {
                [ITTPromptView showMessage:@"注册成功,请登录"];
                [self.navigationController popViewControllerAnimated:YES];
            }
        } failure:^(NSError *error) {
            [ITTPromptView showMessage:@"失败"];
        }];
    
}

-(void)touchesBegan:(NSSet<UITouch *> *)touches withEvent:(UIEvent *)event
{
    NSLog(@"123");
    for (UITextField *textF in self.view.subviews) {
        [textF resignFirstResponder];
    }
    
   // [self resignFirstResponder];
}
@end
